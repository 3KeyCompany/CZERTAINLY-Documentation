"use strict";(self.webpackChunkczertainly=self.webpackChunkczertainly||[]).push([[2997],{3905:function(t,e,a){a.d(e,{Zo:function(){return u},kt:function(){return d}});var n=a(67294);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){l(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,l=function(t,e){if(null==t)return{};var a,n,l={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(l[a]=t[a]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}var c=n.createContext({}),s=function(t){var e=n.useContext(c),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},u=function(t){var e=s(t.components);return n.createElement(c.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},b=n.forwardRef((function(t,e){var a=t.components,l=t.mdxType,r=t.originalType,c=t.parentName,u=o(t,["components","mdxType","originalType","parentName"]),b=s(a),d=l,m=b["".concat(c,".").concat(d)]||b[d]||p[d]||r;return a?n.createElement(m,i(i({ref:e},u),{},{components:a})):n.createElement(m,i({ref:e},u))}));function d(t,e){var a=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=a.length,i=new Array(r);i[0]=b;var o={};for(var c in e)hasOwnProperty.call(e,c)&&(o[c]=e[c]);o.originalType=t,o.mdxType="string"==typeof t?t:l,i[1]=o;for(var s=2;s<r;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}b.displayName="MDXCreateElement"},85162:function(t,e,a){a.d(e,{Z:function(){return i}});var n=a(67294),l=a(34334),r="tabItem_Ymn6";function i(t){var e=t.children,a=t.hidden,i=t.className;return n.createElement("div",{role:"tabpanel",className:(0,l.Z)(r,i),hidden:a},e)}},65488:function(t,e,a){a.d(e,{Z:function(){return d}});var n=a(83117),l=a(67294),r=a(34334),i=a(72389),o=a(67392),c=a(7094),s=a(12466),u="tabList__CuJ",p="tabItem_LNqP";function b(t){var e,a,i=t.lazy,b=t.block,d=t.defaultValue,m=t.values,h=t.groupId,k=t.className,f=l.Children.map(t.children,(function(t){if((0,l.isValidElement)(t)&&"value"in t.props)return t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof t.type?t.type:t.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=m?m:f.map((function(t){var e=t.props;return{value:e.value,label:e.label,attributes:e.attributes}})),g=(0,o.l)(v,(function(t,e){return t.value===e.value}));if(g.length>0)throw new Error('Docusaurus error: Duplicate values "'+g.map((function(t){return t.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var C=null===d?d:null!=(e=null!=d?d:null==(a=f.find((function(t){return t.props.default})))?void 0:a.props.value)?e:f[0].props.value;if(null!==C&&!v.some((function(t){return t.value===C})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+C+'" but none of its children has the corresponding value. Available values are: '+v.map((function(t){return t.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,c.U)(),N=y.tabGroupChoices,w=y.setTabGroupChoices,A=(0,l.useState)(C),T=A[0],j=A[1],O=[],E=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=h){var x=N[h];null!=x&&x!==T&&v.some((function(t){return t.value===x}))&&j(x)}var I=function(t){var e=t.currentTarget,a=O.indexOf(e),n=v[a].value;n!==T&&(E(e),j(n),null!=h&&w(h,String(n)))},M=function(t){var e,a=null;switch(t.key){case"Enter":I(t);break;case"ArrowRight":var n,l=O.indexOf(t.currentTarget)+1;a=null!=(n=O[l])?n:O[0];break;case"ArrowLeft":var r,i=O.indexOf(t.currentTarget)-1;a=null!=(r=O[i])?r:O[O.length-1]}null==(e=a)||e.focus()};return l.createElement("div",{className:(0,r.Z)("tabs-container",u)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":b},k)},v.map((function(t){var e=t.value,a=t.label,i=t.attributes;return l.createElement("li",(0,n.Z)({role:"tab",tabIndex:T===e?0:-1,"aria-selected":T===e,key:e,ref:function(t){return O.push(t)},onKeyDown:M,onClick:I},i,{className:(0,r.Z)("tabs__item",p,null==i?void 0:i.className,{"tabs__item--active":T===e})}),null!=a?a:e)}))),i?(0,l.cloneElement)(f.filter((function(t){return t.props.value===T}))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},f.map((function(t,e){return(0,l.cloneElement)(t,{key:e,hidden:t.props.value!==T})}))))}function d(t){var e=(0,i.Z)();return l.createElement(b,(0,n.Z)({key:String(e)},t))}},55674:function(t,e,a){a.r(e),a.d(e,{assets:function(){return b},contentTitle:function(){return u},default:function(){return h},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return d}});var n=a(83117),l=a(80102),r=(a(67294),a(3905)),i=a(65488),o=a(85162),c=["components"],s={},u="Callbacks",p={unversionedId:"contributors/attributes/callbacks",id:"contributors/attributes/callbacks",title:"Callbacks",description:"In some cases, the content of the Attribute depends on the content of some other Attribute or some other aspects. This is where we use AttributeCallback to define the callback that will be used to get the content of the Attribute. The callback will be triggered when the mapping rules of the callback definition will be satisfied.",source:"@site/docs/60-contributors/10-attributes/09-callbacks.mdx",sourceDirName:"60-contributors/10-attributes",slug:"/contributors/attributes/callbacks",permalink:"/docs/contributors/attributes/callbacks",draft:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Constraints",permalink:"/docs/contributors/attributes/constraints"},next:{title:"Attributes",permalink:"/docs/contributors/attributes/attributes"}},b={},d=[{value:"Callback properties",id:"callback-properties",level:2},{value:"Special purpose callbacks",id:"special-purpose-callbacks",level:2},{value:"Supported special purpose callbacks",id:"supported-special-purpose-callbacks",level:2},{value:"Callbacks construction samples",id:"callbacks-construction-samples",level:2},{value:"Mapping of the JSON object to the <code>AttributeCallback</code>",id:"mapping-of-the-json-object-to-the-attributecallback",level:3},{value:"Mapping of the JSON object field into the <code>AttributeCallback</code> path variables",id:"mapping-of-the-json-object-field-into-the-attributecallback-path-variables",level:3},{value:"Callbacks model",id:"callbacks-model",level:2}],m={toc:d};function h(t){var e=t.components,a=(0,l.Z)(t,c);return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"callbacks"},"Callbacks"),(0,r.kt)("p",null,"In some cases, the content of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute")," depends on the content of some other ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute")," or some other aspects. This is where we use ",(0,r.kt)("inlineCode",{parentName:"p"},"AttributeCallback")," to define the callback that will be used to get the content of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute"),". The callback will be triggered when the mapping rules of the callback definition will be satisfied."),(0,r.kt)("p",null,"Using this approach, ",(0,r.kt)("inlineCode",{parentName:"p"},"Connector")," can use helper controllers and APIs to achieve loading of the data from the technology and communication with the technology without the need to define the ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute")," content, and therefore be more flexible and dynamic."),(0,r.kt)("admonition",{title:"Attribute callbacks",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"For more information about ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"attributeCallback")," property, see ",(0,r.kt)("a",{parentName:"p",href:"attributes"},"Attributes"),".")),(0,r.kt)("h2",{id:"callback-properties"},"Callback properties"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/3KeyCompany/CZERTAINLY-Interfaces/blob/master/src/main/java/com/czertainly/api/model/common/attribute/v2/callback/AttributeCallback.java"},(0,r.kt)("inlineCode",{parentName:"a"},"AttributeCallback"))," contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Short description"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"callbackContext")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"Context part of callback URL that should be used."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--success"},"Yes"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"callbackMethod")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")),(0,r.kt)("td",{parentName:"tr",align:null},"HTTP method of the callback URL that should be used."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--success"},"Yes"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"mappings")),(0,r.kt)("td",{parentName:"tr",align:null},"set of ",(0,r.kt)("a",{parentName:"td",href:"https://github.com/3KeyCompany/CZERTAINLY-Interfaces/blob/master/src/main/java/com/czertainly/api/model/common/attribute/v2/callback/AttributeCallbackMapping.java"},(0,r.kt)("inlineCode",{parentName:"a"},"AttributeCallbackMapping"))),(0,r.kt)("td",{parentName:"tr",align:null},"Mappings for the callback method, which defines how to use the data in context of the request path variables, query parameter, or body payload."),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--success"},"Yes"))))),(0,r.kt)("p",null,"The complex structure, such as objects, arrays, etc., can be mapped only into the body payload of the callback. If the complex structure will be mapped as path variable or query parameter, only its ",(0,r.kt)("inlineCode",{parentName:"p"},"value")," content property will be used."),(0,r.kt)("p",null,"The following is the sample ",(0,r.kt)("inlineCode",{parentName:"p"},"AttributeCallback")," structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "callbackContext": "/v1/authorityProvider/{authorityUuid}/certificateTemplate",\n  "callbackMethod": "GET",\n  "mappings": [\n    {\n      "from": "authority.uuid", <-- this is the value of the Attribute \'authority\' and its property \'uuid\'\n      "to": "authorityUuid",    <-- we want to put the value \'from\' to the \'authorityUuid\' as the path variable\n      "targets": [\n        "pathVariable"          <-- the name of the path variable should match the \'to\' property\n      ]\n    }\n  ]\n}\n')),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Mappings have various options how to include the data from other ",(0,r.kt)("inlineCode",{parentName:"p"},"Attributes")," and request additional action based on them. See the available options in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/3KeyCompany/CZERTAINLY-Interfaces/blob/master/src/main/java/com/czertainly/api/model/common/attribute/v2/callback/AttributeCallbackMapping.java"},"AttributeCallbackMapping"),".")),(0,r.kt)("h2",{id:"special-purpose-callbacks"},"Special purpose callbacks"),(0,r.kt)("p",null,"CZERTAINLY defines special purpose callbacks that are used for specific treatment of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Attribute")," content."),(0,r.kt)("p",null,"A typical example is the ",(0,r.kt)("inlineCode",{parentName:"p"},"DataAttribute")," with the content type ",(0,r.kt)("inlineCode",{parentName:"p"},"CREDENTIAL"),". Working with the credentials, a typical use case is to push the credentials to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Connector")," that should be authenticated and authorized based on selected credential to specific technology. However, we do not want to reveal the secret and sensitive value of the credential to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client"),"."),(0,r.kt)("p",null,"For that purpose we have a special callback interface that will give the ",(0,r.kt)("inlineCode",{parentName:"p"},"Client")," credentials with the specific kind, however not the content. The content is protected by the platform."),(0,r.kt)("h2",{id:"supported-special-purpose-callbacks"},"Supported special purpose callbacks"),(0,r.kt)("table",null,(0,r.kt)("tr",null,(0,r.kt)("th",null,"Callback"),(0,r.kt)("th",null,"Description")),(0,r.kt)("tr",null,(0,r.kt)("td",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"coreGetCredentials"))),(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "callbackContext": "core/getCredentials",\n  "callbackMethod": "GET",\n  "mappings": [\n    {\n      "to": "credentialKind",\n      "targets": [\n        "pathVariable"\n      ],\n      "value": "Basic"\n    }\n  ]\n}\n')),(0,r.kt)("p",null,"This callback allows to get the list of ",(0,r.kt)("inlineCode",{parentName:"p"},"Credentials")," protecting its sensitive data. The list will contain only UUID and name of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Credentials")," that have the required ",(0,r.kt)("inlineCode",{parentName:"p"},"kind"),".")))),(0,r.kt)("h2",{id:"callbacks-construction-samples"},"Callbacks construction samples"),(0,r.kt)("h3",{id:"mapping-of-the-json-object-to-the-attributecallback"},"Mapping of the JSON object to the ",(0,r.kt)("inlineCode",{parentName:"h3"},"AttributeCallback")),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// definition of the AttributeCallback\nAttributeCallback listValuesForAttributeTwoCallback = new AttributeCallback();\nlistValuesForAttributeTwoCallback.setCallbackContext("/v1/support/values");\nlistValuesForAttributeTwoCallback.setCallbackMethod("POST");\n// map the selected object from attributeOne to callback and put it into body payload into the field with name selectedObject\nSet<AttributeCallbackMapping> mappings = new HashSet<>();\nmappings.add(new AttributeCallbackMapping(\n        "attributeOne",\n        "selectedObject"\n        AttributeValueTarget.BODY));\nlistValuesForAttributeTwoCallback.setMappings(mappings);\nattributeTwo.setAttributeCallback(listCredentialCallback);\n')))),(0,r.kt)("h3",{id:"mapping-of-the-json-object-field-into-the-attributecallback-path-variables"},"Mapping of the JSON object field into the ",(0,r.kt)("inlineCode",{parentName:"h3"},"AttributeCallback")," path variables"),(0,r.kt)(i.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// definition of the AttributeCallback\nAttributeCallback listValuesForAttributeTwoCallback = new AttributeCallback();\nlistValuesForAttributeTwoCallback.setCallbackContext("/v1/support/{authorityId}/{customField}");\nlistValuesForAttributeTwoCallback.setCallbackMethod("GET");\n// map the selected object value from attributeOne to callback and put it into path variable with name authorityId\n// when the name of the Attribute only is specified, the value of the content is taken\nSet<AttributeCallbackMapping> mappings = new HashSet<>();\nmappings.add(new AttributeCallbackMapping(\n        "attributeOne",\n        "authorityId"\n        AttributeValueTarget.PATH_VARIABLE));\n        \n// map the field custom from the selected object to callback and put it into path variable variable with name customField\nmappings.add(new AttributeCallbackMapping(\n        "attributeOne.data.custom",\n        "customField"\n        AttributeValueTarget.PATH_VARIABLE));\nlistValuesForAttributeTwoCallback.setMappings(mappings);\nattributeTwo.setAttributeCallback(listCredentialCallback);\n')))),(0,r.kt)("h2",{id:"callbacks-model"},"Callbacks model"),(0,r.kt)("p",null,"The following diagram represents the callbacks model. Details can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/3KeyCompany/CZERTAINLY-Interfaces/tree/master/src/main/java/com/czertainly/api/model/common/attribute/v2/callback"},"CZERTAINLY Interfaces repository"),"."),(0,r.kt)("p",null,(0,r.kt)("object",{parentName:"p",type:"image/svg+xml",data:"https://www.plantuml.com/plantuml/svg/VOin3i9030JxUyL-8AA02b60g7c4Sp71mboYyqRAyq4dEaIs6ytiEIYLoyiJFeiihjZl3erSxmGdL1iVn61LCsqggSdi4e4BMQrVg5TnxoK_cziARZBFLiRqhNuyJbttzuKZTAMM8Tu0"})))}h.isMDXComponent=!0}}]);