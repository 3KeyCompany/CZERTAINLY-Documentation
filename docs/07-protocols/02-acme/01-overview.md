# Overview

CZERTAINLY implements the power of ACME protocol to automate the process of Certificate Lifecycle by using agents deployed on the target server. The platform offers simple integration with ACME Server with the help of ACME Objects that are easy to configure and to manage.

:::info
ACME in the platform is implemented as per [RFC 8555](https://datatracker.ietf.org/doc/html/rfc8555).
All objects implemented complies with the RFC
:::

## ACME Objects

The following represents the ACME Objects available in the platform

- `ACME Profiles`
- `ACME Accounts`

### ACME Profiles

`ACME Profile` objects specify the configuration for the ACME account. The object consist of configuration like

- DNS Configurations for Challenges
- Order retry and interval configurations
- `RA Profile` relations

See [`ACME Profile`](./acme-profiles) for more information

### ACME Accounts

The platform provides the power to control the Accounts registered by the clients. This adds additional management capabilities and allow the users to have more control on the Accounts. The Account objects are the Objects defined by the [RFC 8555](https://datatracker.ietf.org/doc/html/rfc8555) under section [7.1.2.](https://datatracker.ietf.org/doc/html/rfc8555#section-7.1.2) with additional capabilities to enable and disable them.

To know more details click on [ACME Accounts]("./acme-accounts")

### Operations

Listed below are the operations supported by the platform for ACME.

| Operation            | Description                                                                                                                                                                   | End Points                                                                                                     | Ref                                                                      |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| Directory            | Get the directory object containing the URL for operations and other details including Terms of Service                                                                       | /acme/{acmeProfileName}/directory (or) /acme/raProfile/{raProfileName}/directory                               | [directory](https://datatracker.ietf.org/doc/html/rfc8555#section-7.1.1) |
| New Nonce            | Create a new Anti-Replay Nonce that should be used in the following requests in the header field by the client                                                                | /acme/{acmeProfileName}/new-nonce (or) /acme/raProfile/{raProfileName}/new-nonce                               | [Nonce](https://datatracker.ietf.org/doc/html/rfc8555#section-7.2)       |
| New Account          | Create a new account using the key pair generated by the client, get the existing account using the public key                                                                | /acme/{acmeProfileName}/new-account (or) /acme/raProfile/{raProfileName}/new-account                           | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.3)     |
| Update Account       | Update the account including the Terms of Service and External account binding                                                                                                | /acme/{acmeProfileName}/acct/{accountId} (or) /acme/raProfile/{raProfileName}/acct/{accountId}                 | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.3.2)   |
| New Order            | Place a new order for a certificate. The order will contain the identifiers to which the certificate is being issued. New Order marks the first step in issuing a certificate | /acme/{acmeProfileName}/new-order (or) /acme/raProfile/{raProfileName}/new-order                               | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.4)     |
| Challenge            | Initiate the challenge validation from the server side once the client has satisfied the challenges                                                                           | /acme/{acmeProfileName}/chall/{challengeId} (or) /acme/raProfile/{raProfileName}/chall/{challengeId}           | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.5)     |
| Finalize             | Finalize the order for new certificate by providing the CSR                                                                                                                   | /acme/{acmeProfileName}/order/{orderId}/finalize (or) /acme/raProfile/{raProfileName}/order/{orderId}/finalize | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.4.2)   |
| Download Certificate | Download the certificate once the certificate issuance is completed                                                                                                           | /acme/{acmeProfileName}/cert/{certificateId} (or) /acme/raProfile/{raProfileName}/cert/{certificateId}         | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.3.2)   |
| Revoke Certificate   | Revoke a certificate if it is no longer viable. Revocation operation uses the certificate content for the server to identify                                                  | /acme/{acmeProfileName}/revoke-cert (or) /acme/raProfile/{raProfileName}/order/revoke-cert                     | [Account](https://datatracker.ietf.org/doc/html/rfc8555#section-7.6)     |

### End Points

To work with ACME, the platform requires the combination of `ACME Profiles` and `RA Profiles`. This can be achieved by two different approaches:

- Using `ACME Profile` with default `RA Profile`
- Activating ACME for `RA Profile`

#### Using ACME with default RA Profile

When an acme profile is created, it can be tagged with a default `RA Profile`. This enables the server to use the selected `RA Profile` for Certificate Issuance Information and the `ACME Profile` for ACME Configurations. This mode is best for the scenario where an ACME account has one-to-one relation with RA Profile

##### End Point

The end point for this mode starts `https://<acme-server-ip>:<acme-server-port>/acme/{acme-profile-name}/*`

where acme-profile-name refers to the name of the new profile created.

:::warning
Please note that when an `ACME Profile` is created with a default `RA Profile`, it cannot be used in the other mode. These profiles will not be available to use it in other `RA Profiles`
:::

#### Activating ACME for existing RA Profile

`ACME Profiles` can be created without default `RA Profiles`. These profiles can then be used to activate multiple RA Profiles for ACME Operations. This comes ease when multiple configurations are needed with different CA Configuration and same ACME configuration.

:::info
Same `ACME Profile` can be used with multiple `RA Profiles` with this mode
:::

##### End Point

The end point for this mode starts with `https://<acme-server-ip>:<acme-server-port>/acme/raProfile/{ra-profile-name}/*`

:::warning
The server performs various validations on the end point including the following

- Availability of the profile
- Status of the profile
- If Both `ACME Profile` and `RA Profile` is available and enabled for the configuration

If the validation fails then the server returns appropriate error to the client
:::
